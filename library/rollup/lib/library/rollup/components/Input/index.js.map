{"version":3,"file":"index.js","sources":["../../../../../components/Input/index.tsx"],"sourcesContent":["import React, { useImperativeHandle, useRef } from \"react\";\nimport cls from \"classnames\";\nimport { useControllableValue } from \"../hooks/useControllableValue\";\n\nexport interface InputProps<T> {\n  style?: React.CSSProperties;\n  className?: string | string[];\n  disabled?: boolean;\n  placeholder?: string;\n  allowClear?: boolean;\n  defaultValue?: T;\n  value?: T;\n  onChange?: (value: T, e: any) => void;\n  onPressEnter?: (e: any) => void;\n  onFocus?: (e: any) => void;\n  onBlur?: (e: any) => void;\n  onClear?: () => void;\n}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps<string>>(\n  (props, ref) => {\n    const { placeholder, onPressEnter, style, className } = props;\n\n    // 暴露实例\n    const inputRef = useRef<HTMLInputElement>(null!);\n    useImperativeHandle(\n      ref,\n      () => {\n        // ❌ 错误的写法 (原因未知)\n        // return {\n        //   focus: inputRef.current.focus,\n        //   blur: inputRef.current.blur,\n        // }\n\n        // ✅ 正确的写法\n        return {\n          focus() {\n            inputRef.current.focus();\n          },\n          blur() {\n            inputRef.current.blur();\n          },\n        } as any;\n      },\n      []\n    );\n\n    // 受控&非受控逻辑\n    const [_value, _onChange] = useControllableValue<string>(props);\n\n    return (\n      <div style={style} className={cls(\"input-container\", className)}>\n        <input\n          ref={inputRef}\n          className=\"input-main\"\n          placeholder={placeholder}\n          disabled={props.disabled}\n          value={_value}\n          onChange={(e) => {\n            _onChange(e.target.value, e);\n          }}\n          onKeyUp={(e) => {\n            if (e.keyCode === 13) {\n              onPressEnter?.(e);\n            }\n          }}\n          onFocus={props.onFocus}\n          onBlur={props.onBlur}\n        />\n        {props.allowClear ? (\n          <span\n            role=\"button\"\n            className=\"input-close-button\"\n            onMouseDown={(e) => {\n              // onMouseDown 优先于 onBlur 执行\n              // 我们只利用其优先级高的特性，因此需要避免 mouseDown 原生里的 focus:\n              // 通过 e.preventDefault() 取消 mouseDown 的原生事件，焦点就不会因为 mouseDown 而转移到 closeButton 上。\n              e.preventDefault();\n              props.onClear?.();\n            }}\n          >\n            <svg\n              viewBox=\"0 0 1024 1024\"\n              version=\"1.1\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              p-id=\"2595\"\n              width=\"10\"\n              height=\"10\"\n            >\n              <path\n                d=\"M512 512m-450.56 0a450.56 450.56 0 1 0 901.12 0 450.56 450.56 0 1 0-901.12 0Z\"\n                fill=\"#131415\"\n                p-id=\"2596\"\n              ></path>\n              <path\n                d=\"M717.55776 305.7664l0.67584 0.67584a30.72 30.72 0 0 1 0 43.43808L556.1344 512l162.0992 162.11968a30.72 30.72 0 0 1 0 43.43808l-0.67584 0.67584a30.72 30.72 0 0 1-43.43808 0L512 556.1344l-162.11968 162.0992a30.72 30.72 0 0 1-43.43808 0l-0.67584-0.67584a30.72 30.72 0 0 1 0-43.43808L467.8656 512l-162.0992-162.11968a30.72 30.72 0 0 1 0-43.43808l0.67584-0.67584a30.72 30.72 0 0 1 43.43808 0L512 467.8656l162.11968-162.0992a30.72 30.72 0 0 1 43.43808 0z\"\n                fill=\"#FFFFFF\"\n                p-id=\"2597\"\n              ></path>\n            </svg>\n          </span>\n        ) : null}\n      </div>\n    );\n  }\n);\n\nexport default Input;\n"],"names":["React","useRef","useImperativeHandle","useControllableValue","cls"],"mappings":";;;;;;;;;;AAmBM,MAAA,KAAK,GAAGA,yBAAK,CAAC,UAAU,CAC5B,CAAC,KAAK,EAAE,GAAG,KAAI;IACb,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,KAAK,CAAC;;AAG9D,IAAA,MAAM,QAAQ,GAAGC,YAAM,CAAmB,IAAK,CAAC,CAAC;AACjD,IAAAC,yBAAmB,CACjB,GAAG,EACH,MAAK;;;;;;;QAQH,OAAO;YACL,KAAK,GAAA;AACH,gBAAA,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;aAC1B;YACD,IAAI,GAAA;AACF,gBAAA,QAAQ,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;aACzB;SACK,CAAC;KACV,EACD,EAAE,CACH,CAAC;;IAGF,MAAM,CAAC,MAAM,EAAE,SAAS,CAAC,GAAGC,yCAAoB,CAAS,KAAK,CAAC,CAAC;AAEhE,IAAA,QACEH,yBAAA,CAAA,aAAA,CAAA,KAAA,EAAA,EAAK,KAAK,EAAE,KAAK,EAAE,SAAS,EAAEI,KAAG,CAAC,iBAAiB,EAAE,SAAS,CAAC,EAAA;QAC7DJ,yBACE,CAAA,aAAA,CAAA,OAAA,EAAA,EAAA,GAAG,EAAE,QAAQ,EACb,SAAS,EAAC,YAAY,EACtB,WAAW,EAAE,WAAW,EACxB,QAAQ,EAAE,KAAK,CAAC,QAAQ,EACxB,KAAK,EAAE,MAAM,EACb,QAAQ,EAAE,CAAC,CAAC,KAAI;gBACd,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;AAC/B,aAAC,EACD,OAAO,EAAE,CAAC,CAAC,KAAI;AACb,gBAAA,IAAI,CAAC,CAAC,OAAO,KAAK,EAAE,EAAE;AACpB,oBAAA,YAAY,aAAZ,YAAY,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAZ,YAAY,CAAG,CAAC,CAAC,CAAC;AACnB,iBAAA;AACH,aAAC,EACD,OAAO,EAAE,KAAK,CAAC,OAAO,EACtB,MAAM,EAAE,KAAK,CAAC,MAAM,EACpB,CAAA;QACD,KAAK,CAAC,UAAU,IACfA,yBAAA,CAAA,aAAA,CAAA,MAAA,EAAA,EACE,IAAI,EAAC,QAAQ,EACb,SAAS,EAAC,oBAAoB,EAC9B,WAAW,EAAE,CAAC,CAAC,KAAI;;;;;gBAIjB,CAAC,CAAC,cAAc,EAAE,CAAC;AACnB,gBAAA,CAAA,EAAA,GAAA,KAAK,CAAC,OAAO,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,KAAA,CAAI,CAAC;aACnB,EAAA;YAEDA,yBACE,CAAA,aAAA,CAAA,KAAA,EAAA,EAAA,OAAO,EAAC,eAAe,EACvB,OAAO,EAAC,KAAK,EACb,KAAK,EAAC,4BAA4B,EAC7B,MAAA,EAAA,MAAM,EACX,KAAK,EAAC,IAAI,EACV,MAAM,EAAC,IAAI,EAAA;gBAEXA,yBACE,CAAA,aAAA,CAAA,MAAA,EAAA,EAAA,CAAC,EAAC,+EAA+E,EACjF,IAAI,EAAC,SAAS,EACT,MAAA,EAAA,MAAM,EACL,CAAA;AACR,gBAAAA,yBAAA,CAAA,aAAA,CAAA,MAAA,EAAA,EACE,CAAC,EAAC,kcAAkc,EACpc,IAAI,EAAC,SAAS,EACT,MAAA,EAAA,MAAM,GACL,CACJ,CACD,IACL,IAAI,CACJ,EACN;AACJ,CAAC;;;;"}